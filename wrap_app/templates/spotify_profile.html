{% extends 'base.html' %}

{% block content %}
<div class="profile-container" style="
    background: rgba(0, 0, 0, 0.2);
    padding: 2rem;
    border-radius: 20px;
    backdrop-filter: blur(10px);
    box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);
    border: 1px solid rgba(255, 255, 255, 0.18);
    margin: 20px;
">
    <h2 style="color: #1DB954; font-size: 2rem; margin-bottom: 1.5rem;">Welcome, {{ user_profile.display_name }}</h2>
    <div style="
        background: linear-gradient(45deg, rgba(29, 185, 84, 0.1), rgba(30, 215, 96, 0.1));
        padding: 1rem;
        border-radius: 15px;
        margin-bottom: 2rem;
    ">
        <p>Email: {{ user_profile.email }}</p>
        <p>Country: {{ user_profile.country }}</p>
        <p>Product: {{ user_profile.product }}</p>
    </div>

    {% if top_song %}
        <h3>Most Listened-To Song:</h3>
        <div style="display: flex; align-items: flex-start; gap: 10px;">
            <div style="flex: 1;">
                <p>Title: {{ top_song.title }}</p>
                <p>Artist: {{ top_song.artist }}</p>
                <p>Album: {{ top_song.album }}</p>
                <p>Global Popularity: {{ top_song.popularity }}</p>
            </div>
        <div>
            <img src="{{ top_song.image_url }}" alt="Album cover" style="max-width: 165px; margin-right: 755px; border:5px solid #1DB954;">
        </div>
        </div>
        {% if top_song.preview_url %}
            <audio controls>
                <source src="{{ top_song.preview_url }}" type="audio/mpeg">
                Your browser does not support the audio element.
            </audio>
        {% else %}
            <p>No preview available for this song.</p>
        {% endif %}
    {% else %}
        <p>No data available for top song.</p>
    {% endif %}
<h3>Top 3 Artists</h3>
    {% if top_artists %}
        <ol style="display: flex; padding: 0;">
            {% for artist in top_artists %}
                <li style="margin: 10px; text-align: center;">
                    <h4>{{ artist.name }}</h4>
                    <p>Genre: {{ artist.genre }}</p>
                    {% if artist.image_url %}
                        <img src="{{ artist.image_url }}" alt="Image of {{ artist.name }}" width="150" style = "border:5px solid #1DB954;">
                    {% endif %}
                </li>
            {% endfor %}
        </ol>
    {% else %}
        <p>No data available for top artists.</p>
    {% endif %}
</div>
{% endblock %}